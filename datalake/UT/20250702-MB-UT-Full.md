# UT - Complete Documentation

*Generated: 2025-07-02*
*Metabase Instance: https://drafty-bail.metabaseapp.com*
*Collection ID: 35*

## Table of Contents
1. [Overview](#overview)
2. [Models/Datasets](#modelsdatasets)
3. [Questions/Cards](#questionscards)
4. [Dashboards](#dashboards)
5. [Data Dependencies](#data-dependencies)
6. [Maintenance Notes](#maintenance-notes)

## Overview

### Summary Statistics
- **Total Models/Datasets**: 1
- **Total Questions/Cards**: 1
- **Total Dashboards**: 1
- **Total Items**: 3

## Models/Datasets

Models are reusable data sources that can be used as starting points for questions.

### 1. UT Revenue Triage

**Model ID**: `325`
**Database**: TSC Datalake
**Created**: 2025-07-01
**Creator**: Harrison Roday
**Last Updated**: 2025-07-01

**Source Query**:
```sql
SELECT 
    w.url as customer_domain,
    w.id as widget_id,
CASE 
    WHEN w.notify_emails IS NOT NULL AND w.notify_emails != '' 
    THEN TRIM(REPLACE(SPLIT_PART(w.notify_emails, ';', 1), '?emaillinks', ''))
    ELSE NULL 
END as customer_email,    
    -- Usage metrics (cleaner calculations)
    COUNT(t.*) as transfers_2025,
    ROUND(SUM(t.length)/1073741824.0, 2) as gb_used_2025,  -- More precise GB conversion
    
    -- Payment analysis
    MAX(p.payment_date) as last_payment_date,
    COUNT(p.*) as total_payments_ever,
    SUM(p.amount)/100.0 as total_revenue_ever,
    
    -- Current account status
    w.month_max_data/1073741824.0 as current_plan_gb,
    w.month_data/1073741824.0 as current_usage_gb,
    
    -- Business classifications
    CASE 
        WHEN MAX(p.payment_date) >= '2024-01-01' THEN 'CURRENTLY PAYING'
        WHEN MAX(p.payment_date) < '2024-01-01' THEN 'STOPPED PAYING'
        ELSE 'NEVER PAID'
    END as payment_status,
    
    CASE 
        WHEN ROUND(SUM(t.length)/1073741824.0, 2) > 150 THEN 'Custom Enterprise ($150/mo)'
        WHEN ROUND(SUM(t.length)/1073741824.0, 2) > 40 THEN 'Enterprise ($79/mo)'
        WHEN ROUND(SUM(t.length)/1073741824.0, 2) > 20 THEN 'Professional ($35/mo)'
        WHEN ROUND(SUM(t.length)/1073741824.0, 2) > 5 THEN 'Standard ($19/mo)'
        ELSE 'Basic ($9/mo)'
    END as suggested_tier,
    
    -- Revenue opportunity calculation
    CASE 
        WHEN ROUND(SUM(t.length)/1073741824.0, 2) > 150 THEN 150
        WHEN ROUND(SUM(t.length)/1073741824.0, 2) > 40 THEN 79
        WHEN ROUND(SUM(t.length)/1073741824.0, 2) > 20 THEN 35
        WHEN ROUND(SUM(t.length)/1073741824.0, 2) > 5 THEN 19
        ELSE 9
    END as monthly_revenue_potential,
    
    -- Key business metrics
    EXTRACT(DAYS FROM (CURRENT_DATE - MAX(p.payment_date))) as days_since_last_payment,
    w.active as account_active

FROM ut_sqldb_uploadthingy_p_widget w
LEFT JOIN ut_sqldb_uploadthingy_p_payment p 
    ON w.id = p.widget_id 
    AND p.__hevo__marked_deleted = false
LEFT JOIN ut_sqldb_uploadthingy_vs_transfer t 
    ON w.url = t.widget_domain 
    AND t.create_date >= '2025-01-01'

WHERE w.__hevo__marked_deleted = false
    AND t.widget_domain IS NOT NULL

GROUP BY 
    w.url, w.id, w.notify_emails, w.month_max_data, 
    w.month_data, w.active

HAVING ROUND(SUM(t.length)/1073741824.0, 2) > 0.5

ORDER BY gb_used_2025 DESC
LIMIT 50;
```

## Questions/Cards

These are the analytical queries and visualizations in this collection.

### 1. UT Revenue Triage - Non Payers

**Card ID**: `326`
**Visualization**: table
**Database**: TSC Datalake
**Query Type**: Query Builder
**Created**: 2025-07-01
**Creator**: Harrison Roday

## Dashboards

Interactive dashboards combining multiple visualizations.

### 1. UT Prod Board 

**Dashboard ID**: `37`
**Created**: 2025-07-01
**Creator**: Unknown

**Cards** (1 total):
- UT Revenue Triage - Non Payers (ID: 326) - table

## Data Dependencies

### Tables Referenced

The following tables are referenced in SQL queries:
- `ut_sqldb_uploadthingy_p_payment`
- `ut_sqldb_uploadthingy_p_widget`
- `ut_sqldb_uploadthingy_vs_transfer`

### Database Usage

| Database | Items Using |
|----------|-------------|
| TSC Datalake | 2 |

## Maintenance Notes

### Recently Updated Items
- UT Prod Board  (dashboard) - 2025-07-01
- UT Revenue Triage - Non Payers (question) - 2025-07-01
- UT Revenue Triage (model) - 2025-07-01

---

*This documentation was automatically generated on 2025-07-02*
*For the latest information, visit: https://drafty-bail.metabaseapp.com/collection/35*